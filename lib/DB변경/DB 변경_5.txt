  ğŸ“± í”„ë¡ íŠ¸ì—”ë“œ API ë³€ê²½ì‚¬í•­

  ğŸ”¥ ì¤‘ìš”: Pet ê´€ë ¨ ëª¨ë“  í•„ë“œëª… ë³€ê²½!

  ì£¼ìš” ë³€ê²½ì‚¬í•­:
  - pet_id â†’ pet_idx (ë°˜ë ¤ë™ë¬¼ ì‹ë³„ì)
  - guardian_idx â†’ account_idx (ì†Œìœ ì ì‹ë³„ì)
  - prev_donation_date í•„ë“œ ì¶”ê°€ (ì´ì „ í—Œí˜ˆ ì¼ì)

  1. ë°˜ë ¤ë™ë¬¼ ë“±ë¡ API (POST /api/pets)

  ìš”ì²­ ë°ì´í„°:
  {
    "name": "ë©ë©ì´",
    "species": "ê°•ì•„ì§€",
    "breed": "ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„",
    "age_number": 3,
    "blood_type": "DEA 1.1+",
    "weight_kg": 25.5,
    "pregnant": false,
    "vaccinated": true,
    "has_disease": false,
    "has_birth_experience": null,
    "prev_donation_date": null  // âœ¨ ì‹ ê·œ ë“±ë¡ ì‹œ NULL (ì²« í—Œí˜ˆ)
  }

  ì‘ë‹µ:
  {
    "status": "success",
    "message": "ë°˜ë ¤ë™ë¬¼ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤",
    "data": {
      "pet_idx": 1  // âœ¨ pet_id â†’ pet_idx
    }
  }

  2. ë°˜ë ¤ë™ë¬¼ ëª©ë¡ ì¡°íšŒ API (GET /api/pets)

  ì‘ë‹µ ë°ì´í„°:
  [
    {
      "pet_idx": 1,           // âœ¨ pet_id â†’ pet_idx
      "account_idx": 5,       // âœ¨ guardian_idx â†’ account_idx
      "name": "ë©ë©ì´",
      "species": "ê°•ì•„ì§€",
      "breed": "ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„",
      "age_number": 3,
      "blood_type": "DEA 1.1+",
      "weight_kg": 25.50,
      "pregnant": false,
      "vaccinated": true,
      "has_disease": false,
      "has_birth_experience": null,
      "prev_donation_date": "2024-01-10T14:30:00"  // âœ¨ ì´ì „ í—Œí˜ˆ ì¼ì
    }
  ]

  3. í—Œí˜ˆ ì™„ë£Œ ì²˜ë¦¬ API (PATCH /api/pets/donation-complete) âœ¨ ìƒˆë¡œ ì¶”ê°€

  ìš”ì²­ ë°ì´í„°:
  {
    "pet_idx": 1,
    "donation_date": "2024-02-15T16:00:00"  // í—Œí˜ˆ ì™„ë£Œ ì¼ì‹œ
  }

  ì‘ë‹µ ë°ì´í„°:
  {
    "message": "í—Œí˜ˆ ì™„ë£Œ ì²˜ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
    "pet_idx": 1,
    "prev_donation_date": "2024-02-15T16:00:00",
    "updated_pet": {
      "pet_idx": 1,
      "account_idx": 5,
      "name": "ë©ë©ì´",
      "species": "ê°•ì•„ì§€",
      "breed": "ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„",
      "age_number": 3,
      "blood_type": "DEA 1.1+",
      "weight_kg": 25.50,
      "pregnant": false,
      "vaccinated": true,
      "has_disease": false,
      "has_birth_experience": null,
      "prev_donation_date": "2024-02-15T16:00:00"  // âœ¨ ì—…ë°ì´íŠ¸ëœ ë‚ ì§œ
    }
  }

  ğŸ’» í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê°€ì´ë“œ

  1. í•„ë“œëª… ë³€ê²½ ëŒ€ì‘

  // ê¸°ì¡´ ì½”ë“œ
  const petId = pet.pet_id;
  const ownerId = pet.guardian_idx;

  // ìƒˆë¡œìš´ ì½”ë“œ
  const petId = pet.pet_idx;
  const ownerId = pet.account_idx;

  2. ì´ì „ í—Œí˜ˆ ì¼ì í‘œì‹œ

  const renderPetInfo = (pet) => {
    return (
      <div>
        <h3>{pet.name} ({pet.breed})</h3>
        <p>ë‚˜ì´: {pet.age_number}ì„¸</p>
        <p>í˜ˆì•¡í˜•: {pet.blood_type}</p>
        <p>ì²´ì¤‘: {pet.weight_kg}kg</p>

        {/* ì´ì „ í—Œí˜ˆ ì¼ì í‘œì‹œ */}
        {pet.prev_donation_date ? (
          <p>ì´ì „ í—Œí˜ˆ: {new Date(pet.prev_donation_date).toLocaleDateString()}</p>
        ) : (
          <p>ì²« í—Œí˜ˆ ì˜ˆì •</p>
        )}
      </div>
    );
  };

  3. í—Œí˜ˆ ì™„ë£Œ ì²˜ë¦¬

  const handleDonationComplete = async (petIdx) => {
    const donationData = {
      pet_idx: petIdx,
      donation_date: new Date().toISOString()  // í˜„ì¬ ì‹œê°
    };

    const response = await fetch('/api/pets/donation-complete', {
      method: 'PATCH',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(donationData)
    });

    if (response.ok) {
      const result = await response.json();
      alert(`${result.message}`);
      // ë°˜ë ¤ë™ë¬¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
      refreshPetList();
    }
  };

  4. í—Œí˜ˆ ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨

  const canDonate = (pet) => {
    if (!pet.prev_donation_date) return true; // ì²« í—Œí˜ˆ

    const lastDonation = new Date(pet.prev_donation_date);
    const now = new Date();
    const daysSince = (now - lastDonation) / (1000 * 60 * 60 * 24);

    return daysSince >= 56; // 8ì£¼(56ì¼) ì´ìƒ ê²½ê³¼
  };

  const renderDonationStatus = (pet) => {
    if (canDonate(pet)) {
      return <span className="available">í—Œí˜ˆ ê°€ëŠ¥</span>;
    } else {
      const nextDonationDate = new Date(pet.prev_donation_date);
      nextDonationDate.setDate(nextDonationDate.getDate() + 56);
      return <span className="waiting">ë‹¤ìŒ í—Œí˜ˆ ê°€ëŠ¥ì¼: {nextDonationDate.toLocaleDateString()}</span>;
    }
  };

  ğŸ¯ í•µì‹¬ ë³€ê²½ì  ìš”ì•½

  1. í•„ë“œëª… ë³€ê²½: pet_id â†’ pet_idx, guardian_idx â†’ account_idx
  2. prev_donation_date ì¶”ê°€: ì´ì „ í—Œí˜ˆ ì¼ì ê´€ë¦¬
  3. ì²« í—Œí˜ˆ: prev_donation_dateê°€ NULLì¸ ê²½ìš°
  4. í—Œí˜ˆ ì™„ë£Œ: ë³‘ì›ì—ì„œ PATCH /api/pets/donation-complete í˜¸ì¶œ
  5. í—Œí˜ˆ ì£¼ê¸°: ì´ì „ í—Œí˜ˆ ì¼ì ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒ í—Œí˜ˆ ê°€ëŠ¥ì¼ ê³„ì‚°