대시보드 위젯 통합 리팩토링 계획
Context
문제 상황
현재 3개의 대시보드 파일(user_dashboard.dart, admin_dashboard.dart, hospital_dashboard.dart)에서 공지사항과 칼럼 렌더링 코드가 1,574줄 중복되고 있습니다:

user_dashboard.dart (3,180줄): 공지 272줄 + 칼럼 261줄
admin_dashboard.dart (1,667줄): 공지 267줄 + 칼럼 258줄
hospital_dashboard.dart (1,574줄): 공지 273줄 + 칼럼 263줄
이로 인해:

디자인 변경 시 6곳을 수정해야 함 (3개 대시보드 × 2개 섹션)
버그 수정 시 3개 파일 모두 수정 필요
코드 가독성 저하 (각 파일이 1,500~3,000줄)
목표
공통 위젯을 추출하여:

648줄 (41%) 코드 감소
유지보수성 향상 (1곳만 수정)
향후 확장성 확보 (새 역할/콘텐츠 타입 추가 용이)
구현 계획
1. 새로 생성할 파일 구조

lib/widgets/dashboard/
├── dashboard_view_count_box.dart     # 조회수 박스 위젯
├── dashboard_badge.dart              # 뱃지 위젯 (공지/중요 표시)
├── dashboard_empty_state.dart        # 빈 상태 위젯
├── dashboard_more_button.dart        # "..." 더보기 버튼
├── dashboard_list_item.dart          # 리스트 아이템 (핵심 위젯)
└── dashboard_list_section.dart       # 전체 섹션 (선택사항)
2. 단계별 구현 순서
Phase 1: 작은 위젯 생성 (3시간)
Step 1.1: DashboardViewCountBox

파일: lib/widgets/dashboard/dashboard_view_count_box.dart
코드 절감: 60줄
구현:

class DashboardViewCountBox extends StatelessWidget {
  final int viewCount;
  // 40x36 고정 크기 박스
  // 아이콘(visibility_outlined) + 숫자
  // NumberFormatUtil.formatViewCount() 사용
}
적용 대상: 3개 대시보드의 공지/칼럼 섹션 (6곳)
Step 1.2: DashboardBadge

파일: lib/widgets/dashboard/dashboard_badge.dart
코드 절감: 36줄
구현:

class DashboardBadge extends StatelessWidget {
  final String text;
  final Color? backgroundColor;  // 기본: AppTheme.error
  final Color? textColor;        // 기본: white
}
Step 1.3: DashboardEmptyState

파일: lib/widgets/dashboard/dashboard_empty_state.dart
코드 절감: 48줄
구현:

class DashboardEmptyState extends StatelessWidget {
  final IconData icon;
  final String message;
  // Center > Column > Icon + Text
}
Step 1.4: DashboardMoreButton

파일: lib/widgets/dashboard/dashboard_more_button.dart
코드 절감: 24줄
구현:

class DashboardMoreButton extends StatelessWidget {
  final VoidCallback onTap;
  // "..." 버튼 (전체 목록으로 이동)
}
검증:


flutter analyze
# 각 대시보드에서 시각적 확인
Phase 2: 핵심 리스트 아이템 위젯 (6시간)
Step 2.1: DashboardListItem 생성

파일: lib/widgets/dashboard/dashboard_list_item.dart
코드 절감: 360줄 (가장 큰 중복)
제네릭 타입: DashboardListItem<T> (T = NoticePost 또는 ColumnPost)
핵심 매개변수:

class DashboardListItem<T> extends StatelessWidget {
  final T item;
  final int index;  // 순서 번호
  final VoidCallback onTap;

  // 콜백을 통한 데이터 추출
  final String Function(T) getTitleText;
  final String Function(T) getAuthorText;
  final DateTime Function(T) getCreatedAt;
  final DateTime Function(T) getUpdatedAt;
  final int Function(T) getViewCount;
  final bool Function(T) showBadge;
  final String Function(T)? getBadgeText;

  // 역할별 차이 처리
  final bool enableTextPersonalization;  // User/Hospital만
  final String? userName;
  final String? userNickname;
}
Step 2.2: 순차적 적용 (각 30분)

User 대시보드 공지사항 (텍스트 개인화 포함)
User 대시보드 칼럼
Admin 대시보드 공지사항 (개인화 없음)
Admin 대시보드 칼럼
Hospital 대시보드 공지사항
Hospital 대시보드 칼럼
검증:

 3개 대시보드 모든 섹션 정상 렌더링
 텍스트 개인화 정상 작동 (User/Hospital)
 Admin은 개인화 없이 표시
 MarqueeText 애니메이션 정상
 바텀시트 열기 정상
Phase 3: 고수준 섹션 위젯 (선택사항, 4시간)
Step 3.1: DashboardListSection 생성

파일: lib/widgets/dashboard/dashboard_list_section.dart
코드 절감: 120줄
구현:

class DashboardListSection<T> extends StatelessWidget {
  final bool isLoading;
  final List<T> items;
  final String emptyMessage;
  final IconData emptyIcon;
  final Widget Function(BuildContext, T, int) itemBuilder;
  final VoidCallback? onMoreTap;

  // 내부 로직:
  // - isLoading → CircularProgressIndicator
  // - items.isEmpty → DashboardEmptyState
  // - 그 외 → ListView.separated
}
검증:

 로딩 상태 정상 표시
 빈 상태 정상 표시
 리스트 스크롤 부드러움
3. 중요 파일 목록
수정 대상 (3개)
c:\work\SuperPetConnect_Front\lib\user\user_dashboard.dart

공지사항: 1626-1897줄
칼럼: 1158-1418줄
텍스트 개인화 포함
c:\work\SuperPetConnect_Front\lib\admin\admin_dashboard.dart

공지사항: 661-927줄
칼럼: 929-1186줄
텍스트 개인화 없음
c:\work\SuperPetConnect_Front\lib\hospital\hospital_dashboard.dart

공지사항: 487-759줄
칼럼: 761-1023줄
텍스트 개인화 포함
참조할 파일 (재사용)
lib/models/notice_post_model.dart - NoticePost 구조 및 showBadge 헬퍼
lib/models/column_post_model.dart - ColumnPost 구조
lib/widgets/marquee_text.dart - 기존 애니메이션 텍스트 (재사용)
lib/utils/text_personalization_util.dart - personalizeTitle() 메서드
lib/utils/number_format_util.dart - formatViewCount() 메서드
4. 사용 예시
User Dashboard 공지사항

DashboardListItem<NoticePost>(
  item: notice,
  index: index + 1,
  onTap: () => _showNoticeBottomSheet(context, notice),
  getTitleText: (n) => n.title,
  getAuthorText: (n) => n.authorNickname ?? n.authorName,
  getCreatedAt: (n) => n.createdAt,
  getUpdatedAt: (n) => n.updatedAt,
  getViewCount: (n) => n.viewCount ?? 0,
  showBadge: (n) => n.showBadge,
  getBadgeText: (n) => n.badgeText,
  enableTextPersonalization: true,
  userName: userName,
  userNickname: userNickname,
)
Admin Dashboard 공지사항

DashboardListItem<NoticePost>(
  item: notice,
  index: index + 1,
  onTap: () => _showNoticeBottomSheet(context, notice),
  getTitleText: (n) => n.title,
  getAuthorText: (n) => n.authorNickname ?? n.authorName,
  getCreatedAt: (n) => n.createdAt,
  getUpdatedAt: (n) => n.updatedAt,
  getViewCount: (n) => n.viewCount ?? 0,
  showBadge: (n) => n.showBadge,
  getBadgeText: (n) => n.badgeText,
  enableTextPersonalization: false,  // Admin은 개인화 없음
)
5. 검증 계획
5.1 정적 분석

flutter analyze
# 목표: 0 issues
5.2 각 역할별 동작 확인
User Dashboard

 공지사항 리스트 정상 렌더링
 칼럼 리스트 정상 렌더링
 텍스트 개인화: [이름] → 실제 닉네임
 뱃지 표시 (notice_important == 0)
 조회수 박스 정상
 더보기 버튼 → UserNoticeListScreen 이동
 아이템 클릭 → 바텀시트 표시
Admin Dashboard

 공지사항 필터링 없음 (모두 표시)
 칼럼 필터링 없음
 텍스트 개인화 비활성화
 더보기 버튼 → AdminNoticeListScreen 이동
 칼럼 클릭 시 상세 정보 API 호출
Hospital Dashboard

 공지사항 필터링 (targetAudience 0 또는 2)
 칼럼 필터링 (targetAudience 0 또는 2)
 텍스트 개인화 정상 작동
 더보기 버튼 → HospitalNoticeListScreen 이동
5.3 회귀 테스트
데이터 로딩

 앱 시작 시 대시보드 데이터 정상 로딩
 로딩 중 CircularProgressIndicator 표시
 빈 상태 메시지 표시
 네트워크 에러 시 크래시 없음
UI 정합성

 리스트 아이템 간격 1px (separator)
 순서 번호 1부터 시작
 날짜 포맷: yy.MM.dd
 조회수 박스: 40x36 고정
 뱃지 색상: AppTheme.error
성능

 리스트 스크롤 부드러움 (60fps)
 메모리 누수 없음
 앱 시작 시간 변화 ±100ms 이내
6. 예상 결과
코드 절감
Phase	절감 예상	누적
Phase 1 (작은 위젯)	168줄	168줄
Phase 2 (리스트 아이템)	360줄	528줄
Phase 3 (섹션 위젯)	120줄	648줄
총 절감: 648줄 (원본 1,574줄의 41%)

유지보수성 향상
Before: 뱃지 색상 변경 → 6곳 수정
After: 뱃지 색상 변경 → 1곳 수정 (dashboard_badge.dart)
7. 타임라인
Phase 1: 3시간 (작은 위젯)
Phase 2: 6시간 (핵심 위젯)
Phase 3: 4시간 (선택사항)
총 예상 시간: 9-13시간 (Phase 3 포함 여부에 따라)

8. 위험 완화
기능 손상 방지
작은 위젯부터 점진적 적용
각 위젯 적용 후 즉시 테스트
타입 안전성 확보 (제네릭 타입)
성능 유지
const 생성자 최대 활용
불필요한 리빌드 방지
MarqueeText 기존 방식 유지
롤백 계획

# Phase별 커밋
git commit -m "리팩토링: Phase 1 - 대시보드 작은 위젯 추출"
git commit -m "리팩토링: Phase 2 - 대시보드 리스트 아이템 통합"
git commit -m "리팩토링: Phase 3 - 대시보드 섹션 위젯 통합"

# 문제 발생 시
git revert <commit-hash>
9. 성공 기준
 flutter analyze 0 issues
 코드 648줄 이상 감소
 3개 대시보드 모든 기능 정상 작동
 UI 1px 차이 없음
 성능 변화 없음 (±5%)
 새 개발자가 위젯 사용법 이해 가능
10. 향후 확장
새 콘텐츠 타입 추가 시


// 예: 이벤트 리스트
DashboardListItem<EventPost>(
  item: event,
  getTitleText: (e) => e.title,
  // ... 콜백만 정의하면 즉시 사용 가능
)
새 역할 추가 시

기존 위젯 재사용
필터링 로직만 추가
